[manifest]
version = "1.0.0"
dump_lua = true
priority = 0

# Ogerpon Cornestone "Stones have a rank"
[[patches]]
[patches.pattern]
target = 'card.lua'
pattern = "function Card:get_id()"
position = 'after'
match_indent = true
payload = '''
    local ogerpons_cornerstone = find_joker('ogerpon_cornerstone')
    if #ogerpons_cornerstone > 0 and self.ability.effect == 'Stone Card' then
        return SMODS.Ranks["maelmc_Ogerpon"].id
    end
'''

# Gym Challenge applying perish to jokers created (mainly for jokers in shop and boosters as Gym Leader already applies to jokers possessed)
[[patches]]
[patches.pattern]
target = "functions/common_events.lua"
pattern = "if card.ability.consumeable and not skip_materialize then card:start_materialize() end"
position = "after"
match_indent = true
payload = '''
if _type == 'Joker' and G.GAME.modifiers.maelmc_gym_challenge and not (get_type(card) == G.GAME.maelmc_gym_leader_type) then card:set_perishable(true) end
'''

